{% block scripts %}
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <!-- Código de inicialización de Google Maps -->
  <script>
    function initMap() {
      // Define una ubicación por defecto (por ejemplo, Lima, Perú)
      const defaultLocation = { lat: -12.0464, lng: -77.0428 };
      // Crea el mapa en el elemento con id "map"
      const map = new google.maps.Map(document.getElementById("map"), {
        center: defaultLocation,
        zoom: 13,
      });
      // Coloca un marcador en la ubicación por defecto, que se puede arrastrar
      const marker = new google.maps.Marker({
        position: defaultLocation,
        map: map,
        draggable: true,
      });
      // Actualiza el campo de ubicación con las coordenadas cuando se mueve el marcador
      google.maps.event.addListener(marker, 'dragend', function(event) {
        document.getElementById('ubicacion_envio').value =
          event.latLng.lat() + ', ' + event.latLng.lng();
      });
    }
    // Hacemos accesible la función initMap globalmente
    window.initMap = initMap;
  </script>

  <!-- Carga asíncrona de la API de Google Maps: reemplaza YOUR_GOOGLE_MAPS_API_KEY por tu clave -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyARRVaoINbxeDmpAeI1Uh3fvbi8w0qu0t4&callback=initMap"></script>
{% endblock %}
