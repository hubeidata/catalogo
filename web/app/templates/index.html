{% extends "base.html" %}

{% block content %}
<div class="container">
  <div class="row">
    <!-- Barra lateral izquierda con categorías -->
    <aside class="col-md-3">
      <h4>Filtrar por Categoría</h4>
      <ul class="list-group">
        <li class="list-group-item active filtro" data-categoria="todos">Ver todos</li>
        {% for categoria in categorias %}
          <li class="list-group-item filtro" data-categoria="{{ categoria }}">
            {{ categoria|replace('_', ' ')|title }}
          </li>
        {% endfor %}
      </ul>
    </aside>

    <!-- Contenedor de productos -->
    <div class="col-md-9">
      <h1 class="text-center romantic">Catálogo de Productos para San Valentín 20255</h1>
      <div class="row" id="productos-container">
        {% for producto in productos %}
          <div class="col-6 col-md-4 col-lg-3 producto" data-categoria="{{ producto['categoria'] }}">
            <div class="card mb-4">
              <div class="img-container">
                <img src="{{ url_for('static', filename= producto['imagen'] + '.jpeg') }}" class="card-img-top img-fixed-height" alt="{{ producto['nombre'] }}">
              </div>
              <div class="card-body">
                <h5 class="card-title">{{ producto['nombre'] }}</h5>
                <p class="card-text">{{ producto['descripcion'] }}</p>
                <p class="card-text"><strong>Precio: S/ {{ producto['precio'] }}</strong></p>
                <a href="{{ url_for('add_to_cart', codigo=producto['codigo']) }}" class="btn btn-danger">Comprar</a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<!-- JavaScript para filtrar productos -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const filtros = document.querySelectorAll(".filtro");
  filtros.forEach(filtro => {
    filtro.addEventListener("click", function () {
      document.querySelector(".list-group-item.active").classList.remove("active");
      this.classList.add("active");

      let categoriaSeleccionada = this.getAttribute("data-categoria");
      let productos = document.querySelectorAll(".producto");

      productos.forEach(producto => {
        if (categoriaSeleccionada === "todos" || producto.getAttribute("data-categoria") === categoriaSeleccionada) {
          producto.style.display = "block";
        } else {
          producto.style.display = "none";
        }
      });
    });
  });
});
</script>

{% endblock %}